Всегда отвечай мне на русском языке.---
description: Инструкции по разработке проекта LangV Player на C# / WPF.

Шаг 0: Настройка проекта и Правила (Context & Rules)
"Мы начинаем разработку проекта LangV Player — нативного видеоплеера для Windows на C# / WPF (.NET 8).

Твои инструкции:

В корне проекта создай файл DEV_LOG.md. Записывай туда каждую решенную проблему: 'Проблема -> Причина -> Решение'. Читай этот файл перед каждым новым кодом.

Движок: Mpv.NET. Интерфейс: WPF, темная тема, без рамок.

Главная цель: Изучение языков через видео (2 пары субтитров, кликабельные слова, экспорт в Anki).

Код должен быть чистым, с комментариями на английском и русском языке.

Подтверди готовность, и мы перейдем к Шагу 1."

Шаг 1: Окно и Видео-движок
"Реализуй Шаг 1 для LangV Player:

Установи NuGet пакеты: Mpv.NET, Newtonsoft.Json, Microsoft.Data.Sqlite.

Создай MainWindow.xaml: темная тема, стиль без рамок, кастомный TitleBar с кнопками Закрыть/Свернуть.

Реализуй сохранение размера и позиции окна в settings.json.

Добавь в TitleBar кнопку 'Pin' для функции 'Всегда поверх всех окон' и отображения на всех виртуальных рабочих столах через WinAPI.

Инициализируй Mpv.NET и добавь кнопку выбора локального видеофайла."

Шаг 2: Управление и Горячие клавиши
"Шаг 2: Логика управления:

Горячие клавиши: Space (пауза), Стрелки (перемотка +/- 10с, громкость), Enter (полный экран).

Добавь ползунок (Slider) для перемотки и текстовый индикатор текущего времени/длительности.

Реализуй автоматическое скрытие панели управления через 3 секунды бездействия мыши."

Шаг 3: Субтитры и Словари (Интерактив)
"Шаг 3: Сердце LangV Player:

Создай слой для двух независимых файлов субтитров (.srt).

ДОПОЛНЕНИЕ: "Раз мы перешли на LibVLCSharp, давай подготовим базу для интерактивных субтитров:

Напиши класс SubtitleItem, который содержит StartTime, EndTime и Text.

Напиши простой парсер .srt файлов, который загружает субтитры в List<SubtitleItem>.

В MainWindow.xaml поверх VideoView добавь прозрачный ItemsControl или Canvas.

Создай таймер (DispatcherTimer), который каждые 100мс будет спрашивать у _mediaPlayer.Time текущее время и отображать соответствующие субтитры в нашем прозрачном слое.

Важно: Отключи встроенное отображение субтитров в VLC, чтобы они не дублировались."

Каждое слово в иностранном субтитре должно быть кликабельным (используй WrapPanel и TextBlock для каждого слова).

Логика наведения: При наведении на слово видео ставится на паузу и появляется Popup.

В Popup покажи перевод из локальной базы SQLite (DictionaryService). Если слова нет — добавь кнопку 'Перевести через ИИ' (OpenAI).

Добавь кнопку 'Добавить в Anki' для сохранения слова, перевода и контекста."

Шаг 4: Словари и Экспорт в Anki
"Шаг 4: Базы данных и Экспорт:

Реализуй DictionaryService для работы со словарями в формате SQLite (с индексами для быстрого поиска).

Напиши экспорт накопленных слов в формат .apkg (используй библиотеку AnkiNet).

Добавь простую страницу настроек для импорта CSV-словарей и ввода API-ключа для ИИ."