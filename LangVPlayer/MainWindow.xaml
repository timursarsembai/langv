<Window x:Class="LangVPlayer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LangVPlayer"
        xmlns:vlc="clr-namespace:LibVLCSharp.WPF;assembly=LibVLCSharp.WPF"
        mc:Ignorable="d"
        Title="LangV Player"
        Height="720" Width="1280"
        MinHeight="400" MinWidth="600"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="{StaticResource PrimaryBackgroundBrush}"
        Loaded="Window_Loaded"
        Closing="Window_Closing"
        PreviewKeyDown="Window_PreviewKeyDown">
    
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="0" ResizeBorderThickness="5"/>
    </WindowChrome.WindowChrome>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <!-- Main content / Основной контент -->
            <ColumnDefinition Width="*"/>
            <!-- Playlist panel / Панель плейлиста -->
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        
        <!-- Main Player Area / Основная область плеера -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <!-- TitleBar / Заголовок -->
                <RowDefinition Height="30"/>
                <!-- Video Area / Область видео -->
                <RowDefinition Height="*"/>
                <!-- Control Panel / Панель управления -->
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

        <!-- Custom TitleBar / Кастомный заголовок -->
        <Grid Grid.Row="0" Background="{StaticResource TitleBarBrush}" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Menu Button / Кнопка меню -->
            <Menu Grid.Column="0" Background="Transparent" VerticalAlignment="Center" Margin="5,0,0,0">
                <MenuItem Header="☰" FontSize="16" Foreground="{StaticResource TextBrush}" 
                          Background="Transparent" BorderThickness="0" Padding="8,4">
                    <!-- File Menu / Меню Файл -->
                    <MenuItem Header="📁 Файл">
                        <MenuItem Header="Открыть файл..." Click="MenuOpenFile_Click" InputGestureText="Ctrl+O"/>
                        <MenuItem Header="Открыть URL..." Click="MenuOpenUrl_Click" InputGestureText="Ctrl+U"/>
                        <Separator/>
                        <MenuItem Header="Выход" Click="CloseButton_Click" InputGestureText="Alt+F4"/>
                    </MenuItem>
                    <!-- Playback Menu / Меню Воспроизведение -->
                    <MenuItem Header="▶ Воспроизведение">
                        <MenuItem x:Name="MenuPlayPause" Header="Воспроизвести" Click="PlayPauseButton_Click" InputGestureText="Space"/>
                        <MenuItem Header="Стоп" Click="MenuStop_Click"/>
                        <Separator/>
                        <MenuItem Header="Перемотать назад (-10с)" Click="RewindButton_Click" InputGestureText="←"/>
                        <MenuItem Header="Перемотать вперёд (+10с)" Click="ForwardButton_Click" InputGestureText="→"/>
                        <Separator/>
                        <MenuItem Header="Громкость +" Click="MenuVolumeUp_Click" InputGestureText="↑"/>
                        <MenuItem Header="Громкость -" Click="MenuVolumeDown_Click" InputGestureText="↓"/>
                    </MenuItem>
                    <!-- View Menu / Меню Вид -->
                    <MenuItem Header="🖥 Вид">
                        <MenuItem x:Name="MenuFullscreen" Header="На полный экран" Click="FullscreenButton_Click" InputGestureText="F11"/>
                        <MenuItem x:Name="MenuAlwaysOnTop" Header="Поверх всех окон" IsCheckable="True" 
                                  Checked="MenuAlwaysOnTop_Checked" Unchecked="MenuAlwaysOnTop_Unchecked"/>
                    </MenuItem>
                    <!-- Help Menu / Меню Справка -->
                    <MenuItem Header="❓ Справка">
                        <MenuItem Header="О программе..." Click="MenuAbout_Click"/>
                    </MenuItem>
                </MenuItem>
            </Menu>

            <!-- App Title / Название приложения -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="5,0">
                <TextBlock Text="🎬" FontSize="14" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBlock Text="LangV Player" Foreground="{StaticResource TextBrush}" FontSize="12" VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Window Buttons / Кнопки окна -->
            <StackPanel Grid.Column="3" Orientation="Horizontal">
                <!-- Pin Button / Кнопка закрепления -->
                <ToggleButton x:Name="PinButton" 
                              Style="{StaticResource PinButtonStyle}" 
                              Content="&#xE718;"
                              ToolTip="Always on Top / Всегда поверх"
                              Focusable="False"
                              Checked="PinButton_Checked"
                              Unchecked="PinButton_Unchecked"/>
                
                <!-- Minimize Button / Кнопка сворачивания -->
                <Button Style="{StaticResource TitleBarButtonStyle}" 
                        Content="&#xE921;" 
                        Focusable="False"
                        Click="MinimizeButton_Click"
                        ToolTip="Minimize / Свернуть"/>
                
                <!-- Maximize Button / Кнопка развертывания -->
                <Button x:Name="MaximizeButton"
                        Style="{StaticResource TitleBarButtonStyle}" 
                        Content="&#xE922;" 
                        Focusable="False"
                        Click="MaximizeButton_Click"
                        ToolTip="Maximize / Развернуть"/>
                
                <!-- Close Button / Кнопка закрытия -->
                <Button Style="{StaticResource CloseButtonStyle}" 
                        Content="&#xE8BB;" 
                        Focusable="False"
                        Click="CloseButton_Click"
                        ToolTip="Close / Закрыть"/>
            </StackPanel>
        </Grid>

        <!-- Video Area / Область видео -->
        <Grid Grid.Row="1" Background="Black" x:Name="VideoArea">
            <!-- VLC VideoView for video playback / VLC VideoView для воспроизведения видео -->
            <!-- Mouse overlay must be INSIDE VideoView with semi-transparent background per LibVLCSharp docs -->
            <!-- Слой для событий мыши должен быть ВНУТРИ VideoView с полупрозрачным фоном по документации LibVLCSharp -->
            <vlc:VideoView x:Name="VideoView" Background="Black">
                <Grid>
                    <!-- Invisible overlay for mouse events / Невидимый слой для событий мыши -->
                    <Grid x:Name="VideoOverlay" 
                          Background="#01000000"
                          MouseLeftButtonDown="VideoOverlay_MouseLeftButtonDown"
                          MouseMove="VideoOverlay_MouseMove"
                          MouseWheel="VideoOverlay_MouseWheel"/>
                    
                    <!-- Placeholder when no video (on top of overlay) / Заглушка при отсутствии видео (поверх overlay) -->
                    <StackPanel x:Name="NoVideoPlaceholder" 
                                VerticalAlignment="Center" 
                                HorizontalAlignment="Center"
                                Visibility="Visible">
                        <TextBlock Text="🎬" FontSize="64" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBlock Text="Drop video file here or click to open" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   FontSize="16" 
                                   HorizontalAlignment="Center"
                                   Margin="0,10,0,0"/>
                        <TextBlock Text="Перетащите видеофайл сюда или нажмите для открытия" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   FontSize="12" 
                                   HorizontalAlignment="Center"
                                   Margin="0,5,0,0"/>
                        <Button x:Name="OpenFileButton" 
                                Content="📁 Open Video / Открыть видео" 
                                Margin="0,20,0,0"
                                Padding="20,10"
                                Background="{StaticResource AccentBrush}"
                                Foreground="White"
                                BorderThickness="0"
                                FontSize="14"
                                Focusable="False"
                                Cursor="Hand"
                                Click="OpenFileButton_Click"/>
                    </StackPanel>
                </Grid>
            </vlc:VideoView>
        </Grid>

        <!-- Control Panel / Панель управления -->
        <Grid Grid.Row="2" x:Name="ControlPanel" Background="{StaticResource SecondaryBackgroundBrush}" Height="120">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Timeline Slider / Ползунок таймлайна -->
            <Grid Grid.Row="0" Margin="15,10,15,0">
                <Slider x:Name="TimelineSlider" 
                        Style="{StaticResource VideoSliderStyle}"
                        Minimum="0" 
                        Maximum="100" 
                        Value="0"
                        Focusable="False"
                        ValueChanged="TimelineSlider_ValueChanged"
                        Thumb.DragStarted="TimelineSlider_DragStarted"
                        Thumb.DragCompleted="TimelineSlider_DragCompleted"/>
            </Grid>

            <!-- Controls / Элементы управления -->
            <Grid Grid.Row="1" Margin="15,5,15,10">
                <!-- Playback Controls centered in window / Кнопки воспроизведения по центру окна -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!-- Rewind / Перемотка назад -->
                    <Button Style="{StaticResource ControlButtonStyle}" 
                            Content="&#xEB9E;" 
                            Width="40" Height="40"
                            Focusable="False"
                            VerticalAlignment="Center"
                            Click="RewindButton_Click"
                            ToolTip="Rewind 10s / Назад 10с"/>
                    
                    <!-- Play/Pause / Воспроизведение/Пауза -->
                    <Button x:Name="PlayPauseButton" 
                            Style="{StaticResource ControlButtonStyle}" 
                            Content="&#xE768;" 
                            Width="50" Height="50"
                            Focusable="False"
                            VerticalAlignment="Center"
                            Click="PlayPauseButton_Click"
                            ToolTip="Play/Pause / Воспроизведение/Пауза"/>
                    
                    <!-- Forward / Перемотка вперед -->
                    <Button Style="{StaticResource ControlButtonStyle}" 
                            Content="&#xEB9D;"
                            Focusable="False" 
                            Width="40" Height="40"
                            VerticalAlignment="Center"
                            Click="ForwardButton_Click"
                            ToolTip="Forward 10s / Вперед 10с"/>
                </StackPanel>

                <!-- Time Display on left / Отображение времени слева -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                    <TextBlock x:Name="CurrentTimeText" 
                               Text="00:00:00" 
                               Foreground="{StaticResource TextBrush}" 
                               FontSize="12"
                               VerticalAlignment="Center"/>
                    <TextBlock Text=" / " 
                               Foreground="{StaticResource TextSecondaryBrush}" 
                               FontSize="12"
                               VerticalAlignment="Center"/>
                    <TextBlock x:Name="TotalTimeText" 
                               Text="00:00:00" 
                               Foreground="{StaticResource TextSecondaryBrush}" 
                               FontSize="12"
                               VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Volume & Fullscreen on right / Громкость и полный экран справа -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <!-- Volume Icon (clickable to mute) / Иконка громкости (клик для mute) -->
                    <TextBlock x:Name="VolumeIcon" 
                               Text="&#xE767;" 
                               FontFamily="Segoe MDL2 Assets" 
                               FontSize="16"
                               Foreground="{StaticResource TextBrush}" 
                               VerticalAlignment="Center"
                               Margin="0,0,5,0"
                               Cursor="Hand"
                               MouseLeftButtonDown="VolumeIcon_MouseLeftButtonDown"
                               ToolTip="Mute / Отключить звук"/>
                    
                    <!-- Volume Slider / Ползунок громкости -->
                    <Slider x:Name="VolumeSlider" 
                            Width="80" 
                            Minimum="0" 
                            Maximum="200" 
                            Value="100"
                            IsMoveToPointEnabled="True"
                            Focusable="False"
                            VerticalAlignment="Center"
                            ValueChanged="VolumeSlider_ValueChanged"/>
                    
                    <!-- Volume Percentage / Процент громкости -->
                    <TextBlock x:Name="VolumePercentText"
                               Text="100%"
                               Foreground="{StaticResource TextBrush}"
                               FontSize="12"
                               Width="35"
                               TextAlignment="Right"
                               VerticalAlignment="Center"
                               Margin="5,0,0,0"/>
                    
                    <!-- Playlist Button / Кнопка плейлиста -->
                    <Button x:Name="PlaylistButton"
                            Style="{StaticResource ControlButtonStyle}" 
                            Content="&#xE8FD;" 
                            Width="40" Height="40"
                            Margin="5,0,0,0"
                            Focusable="False"
                            Click="PlaylistButton_Click"
                            ToolTip="Playlist / Плейлист"/>
                    
                    <!-- Fullscreen Button / Кнопка полного экрана -->
                    <Button x:Name="FullscreenButton"
                            Style="{StaticResource ControlButtonStyle}" 
                            Content="&#xE740;" 
                            Width="40" Height="40"
                            Margin="5,0,0,0"
                            Focusable="False"
                            Click="FullscreenButton_Click"
                            ToolTip="Fullscreen / Полный экран"/>
                </StackPanel>
            </Grid>
        </Grid>
        </Grid>
        
        <!-- Playlist Panel / Панель плейлиста -->
        <Grid x:Name="PlaylistPanel" Grid.Column="1" Width="300" Background="{StaticResource SecondaryBackgroundBrush}"
              Visibility="Collapsed">
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- Playlist Header / Заголовок плейлиста -->
            <Grid Grid.Row="0" Background="{StaticResource TitleBarBrush}">
                <TextBlock Text="📋 Плейлист" 
                           Foreground="{StaticResource TextBrush}" 
                           FontSize="14" 
                           VerticalAlignment="Center" 
                           Margin="10,0,0,0"/>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,5,0">
                    <!-- Add Files Button / Кнопка добавления файлов -->
                    <Button Style="{StaticResource TitleBarButtonStyle}"
                            Content="&#xE710;"
                            Focusable="False"
                            Click="PlaylistAddFiles_Click"
                            ToolTip="Add files / Добавить файлы"/>
                    
                    <!-- Clear Playlist Button / Кнопка очистки плейлиста -->
                    <Button Style="{StaticResource TitleBarButtonStyle}"
                            Content="&#xE74D;"
                            Focusable="False"
                            Click="PlaylistClear_Click"
                            ToolTip="Clear playlist / Очистить плейлист"/>
                </StackPanel>
            </Grid>
            
            <!-- Playlist Items / Элементы плейлиста -->
            <ListBox x:Name="PlaylistListBox" 
                     Grid.Row="1" 
                     Background="Transparent"
                     BorderThickness="0"
                     Foreground="{StaticResource TextBrush}"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                     SelectionMode="Single"
                     MouseDoubleClick="PlaylistListBox_MouseDoubleClick">
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Padding" Value="10,8"/>
                        <Setter Property="Cursor" Value="Hand"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <Border x:Name="Bd" 
                                            Background="Transparent" 
                                            Padding="{TemplateBinding Padding}"
                                            BorderThickness="0,0,0,1"
                                            BorderBrush="{StaticResource BorderBrush}">
                                        <ContentPresenter/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Bd" Property="Background" Value="#30FFFFFF"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Bd" Property="Background" Value="{StaticResource AccentBrush}"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Playing indicator / Индикатор воспроизведения -->
                            <TextBlock Grid.Column="0" 
                                       Text="▶" 
                                       Foreground="{StaticResource AccentBrush}"
                                       FontSize="12"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"
                                       Visibility="{Binding IsPlaying, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            
                            <!-- File name / Имя файла -->
                            <TextBlock Grid.Column="1" 
                                       Text="{Binding FileName}" 
                                       Foreground="{StaticResource TextBrush}"
                                       TextTrimming="CharacterEllipsis"
                                       VerticalAlignment="Center"
                                       ToolTip="{Binding FilePath}"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Grid>
    </Grid>
</Window>
